<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>The R in Spark: Learning Apache Spark with R</title>
  <meta name="description" content="A book to learn Apache Spark with R using the sparklyr R package.">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="The R in Spark: Learning Apache Spark with R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A book to learn Apache Spark with R using the sparklyr R package." />
  <meta name="github-repo" content="javierluraschi/the-r-in-spark" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="The R in Spark: Learning Apache Spark with R" />
  
  <meta name="twitter:description" content="A book to learn Apache Spark with R using the sparklyr R package." />
  



<meta name="date" content="2018-12-18">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="modeling.html">
<link rel="next" href="connections.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-119986300-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-119986300-1');
</script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">Learning Apache Spark with R</a></strong></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#structure"><i class="fa fa-check"></i>Structure</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#authors"><i class="fa fa-check"></i>Authors</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#acknowledgments"><i class="fa fa-check"></i>Acknowledgments</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#intro-background"><i class="fa fa-check"></i><b>1.1</b> Background</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#intro-spark"><i class="fa fa-check"></i><b>1.2</b> Spark</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#intro-r"><i class="fa fa-check"></i><b>1.3</b> R</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#intro-sparklyr"><i class="fa fa-check"></i><b>1.4</b> sparklyr</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="starting.html"><a href="starting.html"><i class="fa fa-check"></i><b>2</b> Getting Started</a><ul>
<li class="chapter" data-level="2.1" data-path="starting.html"><a href="starting.html#starting-prerequisites"><i class="fa fa-check"></i><b>2.1</b> Prerequisites</a><ul>
<li class="chapter" data-level="2.1.1" data-path="starting.html"><a href="starting.html#starting-install-r"><i class="fa fa-check"></i><b>2.1.1</b> Install R</a></li>
<li class="chapter" data-level="2.1.2" data-path="starting.html"><a href="starting.html#starting-install-java"><i class="fa fa-check"></i><b>2.1.2</b> Install Java</a></li>
<li class="chapter" data-level="2.1.3" data-path="starting.html"><a href="starting.html#starting-install-rstudio"><i class="fa fa-check"></i><b>2.1.3</b> Install RStudio</a></li>
<li class="chapter" data-level="2.1.4" data-path="starting.html"><a href="starting.html#starting-install-sparklyr"><i class="fa fa-check"></i><b>2.1.4</b> Install sparklyr</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="starting.html"><a href="starting.html#starting-installing-spark"><i class="fa fa-check"></i><b>2.2</b> Installing Spark</a></li>
<li class="chapter" data-level="2.3" data-path="starting.html"><a href="starting.html#starting-connect-to-spark"><i class="fa fa-check"></i><b>2.3</b> Connecting to Spark</a></li>
<li class="chapter" data-level="2.4" data-path="starting.html"><a href="starting.html#starting-sparklyr-hello-world"><i class="fa fa-check"></i><b>2.4</b> Using Spark</a></li>
<li class="chapter" data-level="2.5" data-path="starting.html"><a href="starting.html#source-spark-x-1"><i class="fa fa-check"></i><b>2.5</b> # Source: spark<hello> [?? x 1]</a></li>
<li class="chapter" data-level="2.6" data-path="starting.html"><a href="starting.html#line"><i class="fa fa-check"></i><b>2.6</b> line</a></li>
<li class="chapter" data-level="2.7" data-path="starting.html"><a href="starting.html#section"><i class="fa fa-check"></i><b>2.7</b> * <chr></a></li>
<li class="chapter" data-level="2.8" data-path="starting.html"><a href="starting.html#hello-world"><i class="fa fa-check"></i><b>2.8</b> 1 Hello World!</a><ul>
<li class="chapter" data-level="2.8.1" data-path="starting.html"><a href="starting.html#starting-spark-web-interface"><i class="fa fa-check"></i><b>2.8.1</b> Web Interface</a></li>
<li class="chapter" data-level="2.8.2" data-path="starting.html"><a href="starting.html#starting-logs"><i class="fa fa-check"></i><b>2.8.2</b> Logs</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="starting.html"><a href="starting.html#info-sparkcontext-submitted-application-sparklyr"><i class="fa fa-check"></i><b>2.9</b> 18/10/09 18:53:23 INFO SparkContext: Submitted application: sparklyr</a></li>
<li class="chapter" data-level="2.10" data-path="starting.html"><a href="starting.html#info-sparkcontext-added-jar-filelibraryframeworksr.frameworkversions3.5resourceslibrarysparklyrjavasparklyr-2.3-2.11.jar-at-sparklocalhost52930jarssparklyr-2.3-2.11.jar-with-timestamp-1539136403697"><i class="fa fa-check"></i><b>2.10</b> 18/10/09 18:53:23 INFO SparkContext: Added JAR <span>file:/Library/Frameworks/R.framework/Versions/3.5/Resources/library/sparklyr/java/sparklyr-2.3-2.11.jar</span> at spark://localhost:52930/jars/sparklyr-2.3-2.11.jar with timestamp 1539136403697</a></li>
<li class="chapter" data-level="2.11" data-path="starting.html"><a href="starting.html#info-executor-fetching-sparklocalhost52930jarssparklyr-2.3-2.11.jar-with-timestamp-1539136403697"><i class="fa fa-check"></i><b>2.11</b> 18/10/09 18:53:27 INFO Executor: Fetching spark://localhost:52930/jars/sparklyr-2.3-2.11.jar with timestamp 1539136403697</a></li>
<li class="chapter" data-level="2.12" data-path="starting.html"><a href="starting.html#info-utils-fetching-sparklocalhost52930jarssparklyr-2.3-2.11.jar-to-privatevarfolderskswm_bx4cn70s6h0r5vgqpsldm0000gntspark-141b51a3-f277-4530-aa6a-69be176e0c0buserfiles-3d94e32b-c65d-4081-a85e-d1e4716e0ceffetchfiletemp1188493532217239876.tmp"><i class="fa fa-check"></i><b>2.12</b> 18/10/09 18:53:27 INFO Utils: Fetching spark://localhost:52930/jars/sparklyr-2.3-2.11.jar to /private/var/folders/ks/wm_bx4cn70s6h0r5vgqpsldm0000gn/T/spark-141b51a3-f277-4530-aa6a-69be176e0c0b/userFiles-3d94e32b-c65d-4081-a85e-d1e4716e0cef/fetchFileTemp1188493532217239876.tmp</a></li>
<li class="chapter" data-level="2.13" data-path="starting.html"><a href="starting.html#info-executor-adding-fileprivatevarfolderskswm_bx4cn70s6h0r5vgqpsldm0000gntspark-141b51a3-f277-4530-aa6a-69be176e0c0buserfiles-3d94e32b-c65d-4081-a85e-d1e4716e0cefsparklyr-2.3-2.11.jar-to-class-loader"><i class="fa fa-check"></i><b>2.13</b> 18/10/09 18:53:27 INFO Executor: Adding <span>file:/private/var/folders/ks/wm_bx4cn70s6h0r5vgqpsldm0000gn/T/spark-141b51a3-f277-4530-aa6a-69be176e0c0b/userFiles-3d94e32b-c65d-4081-a85e-d1e4716e0cef/sparklyr-2.3-2.11.jar</span> to class loader</a></li>
<li class="chapter" data-level="2.14" data-path="starting.html"><a href="starting.html#starting-disconnecting"><i class="fa fa-check"></i><b>2.14</b> Disconnecting</a></li>
<li class="chapter" data-level="2.15" data-path="starting.html"><a href="starting.html#starting-using-spark-from-rstudio"><i class="fa fa-check"></i><b>2.15</b> RStudio</a></li>
<li class="chapter" data-level="2.16" data-path="starting.html"><a href="starting.html#starting-troubleshooting"><i class="fa fa-check"></i><b>2.16</b> Troubleshooting</a></li>
<li class="chapter" data-level="2.17" data-path="starting.html"><a href="starting.html#starting-recap"><i class="fa fa-check"></i><b>2.17</b> Recap</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="analysis.html"><a href="analysis.html"><i class="fa fa-check"></i><b>3</b> Analysis</a><ul>
<li class="chapter" data-level="3.1" data-path="analysis.html"><a href="analysis.html#overview"><i class="fa fa-check"></i><b>3.1</b> Overview</a></li>
<li class="chapter" data-level="3.2" data-path="analysis.html"><a href="analysis.html#dplyr"><i class="fa fa-check"></i><b>3.2</b> dplyr</a><ul>
<li class="chapter" data-level="3.2.1" data-path="analysis.html"><a href="analysis.html#pass-through-functions"><i class="fa fa-check"></i><b>3.2.1</b> Pass-through Functions</a></li>
<li class="chapter" data-level="3.2.2" data-path="analysis.html"><a href="analysis.html#dplyr-reosurces"><i class="fa fa-check"></i><b>3.2.2</b> Resources</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="analysis.html"><a href="analysis.html#dbi"><i class="fa fa-check"></i><b>3.3</b> DBI</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="modeling.html"><a href="modeling.html"><i class="fa fa-check"></i><b>4</b> Modeling</a><ul>
<li class="chapter" data-level="4.1" data-path="modeling.html"><a href="modeling.html#overview-1"><i class="fa fa-check"></i><b>4.1</b> Overview</a></li>
<li class="chapter" data-level="4.2" data-path="modeling.html"><a href="modeling.html#supervised"><i class="fa fa-check"></i><b>4.2</b> Supervised</a></li>
<li class="chapter" data-level="4.3" data-path="modeling.html"><a href="modeling.html#unsupervised"><i class="fa fa-check"></i><b>4.3</b> Unsupervised</a><ul>
<li class="chapter" data-level="4.3.1" data-path="modeling.html"><a href="modeling.html#k-means-clustering"><i class="fa fa-check"></i><b>4.3.1</b> K-Means Clustering</a></li>
<li class="chapter" data-level="4.3.2" data-path="modeling.html"><a href="modeling.html#gaussian-mixture-clustering"><i class="fa fa-check"></i><b>4.3.2</b> Gaussian Mixture Clustering</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="modeling.html"><a href="modeling.html#broom"><i class="fa fa-check"></i><b>4.4</b> Broom</a></li>
<li class="chapter" data-level="4.5" data-path="modeling.html"><a href="modeling.html#pipelines"><i class="fa fa-check"></i><b>4.5</b> Pipelines</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="clusters.html"><a href="clusters.html"><i class="fa fa-check"></i><b>5</b> Clusters</a><ul>
<li class="chapter" data-level="5.1" data-path="clusters.html"><a href="clusters.html#overview-2"><i class="fa fa-check"></i><b>5.1</b> Overview</a></li>
<li class="chapter" data-level="5.2" data-path="clusters.html"><a href="clusters.html#managers"><i class="fa fa-check"></i><b>5.2</b> Managers</a><ul>
<li class="chapter" data-level="5.2.1" data-path="clusters.html"><a href="clusters.html#clusters-standalone"><i class="fa fa-check"></i><b>5.2.1</b> Standalone</a></li>
<li class="chapter" data-level="5.2.2" data-path="clusters.html"><a href="clusters.html#yarn"><i class="fa fa-check"></i><b>5.2.2</b> Yarn</a></li>
<li class="chapter" data-level="5.2.3" data-path="clusters.html"><a href="clusters.html#mesos"><i class="fa fa-check"></i><b>5.2.3</b> Mesos</a></li>
<li class="chapter" data-level="5.2.4" data-path="clusters.html"><a href="clusters.html#kubernetes"><i class="fa fa-check"></i><b>5.2.4</b> Kubernetes</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="clusters.html"><a href="clusters.html#on-premise"><i class="fa fa-check"></i><b>5.3</b> On-Premise</a><ul>
<li class="chapter" data-level="5.3.1" data-path="clusters.html"><a href="clusters.html#cloudera"><i class="fa fa-check"></i><b>5.3.1</b> Cloudera</a></li>
<li class="chapter" data-level="5.3.2" data-path="clusters.html"><a href="clusters.html#hortonworks"><i class="fa fa-check"></i><b>5.3.2</b> Hortonworks</a></li>
<li class="chapter" data-level="5.3.3" data-path="clusters.html"><a href="clusters.html#mapr"><i class="fa fa-check"></i><b>5.3.3</b> MapR</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="clusters.html"><a href="clusters.html#cloud"><i class="fa fa-check"></i><b>5.4</b> Cloud</a><ul>
<li class="chapter" data-level="5.4.1" data-path="clusters.html"><a href="clusters.html#amazon"><i class="fa fa-check"></i><b>5.4.1</b> Amazon</a></li>
<li class="chapter" data-level="5.4.2" data-path="clusters.html"><a href="clusters.html#databricks"><i class="fa fa-check"></i><b>5.4.2</b> Databricks</a></li>
<li class="chapter" data-level="5.4.3" data-path="clusters.html"><a href="clusters.html#google"><i class="fa fa-check"></i><b>5.4.3</b> Google</a></li>
<li class="chapter" data-level="5.4.4" data-path="clusters.html"><a href="clusters.html#ibm"><i class="fa fa-check"></i><b>5.4.4</b> IBM</a></li>
<li class="chapter" data-level="5.4.5" data-path="clusters.html"><a href="clusters.html#microsoft"><i class="fa fa-check"></i><b>5.4.5</b> Microsoft</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="clusters.html"><a href="clusters.html#tools"><i class="fa fa-check"></i><b>5.5</b> Tools</a><ul>
<li class="chapter" data-level="5.5.1" data-path="clusters.html"><a href="clusters.html#rstudio"><i class="fa fa-check"></i><b>5.5.1</b> RStudio</a></li>
<li class="chapter" data-level="5.5.2" data-path="clusters.html"><a href="clusters.html#jupyter"><i class="fa fa-check"></i><b>5.5.2</b> Jupyter</a></li>
<li class="chapter" data-level="5.5.3" data-path="clusters.html"><a href="clusters.html#clusters-livy"><i class="fa fa-check"></i><b>5.5.3</b> Livy</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="clusters.html"><a href="clusters.html#recap"><i class="fa fa-check"></i><b>5.6</b> Recap</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="connections.html"><a href="connections.html"><i class="fa fa-check"></i><b>6</b> Connections</a><ul>
<li class="chapter" data-level="6.1" data-path="connections.html"><a href="connections.html#overview-3"><i class="fa fa-check"></i><b>6.1</b> Overview</a><ul>
<li class="chapter" data-level="6.1.1" data-path="connections.html"><a href="connections.html#edge-nodes"><i class="fa fa-check"></i><b>6.1.1</b> Edge Nodes</a></li>
<li class="chapter" data-level="6.1.2" data-path="connections.html"><a href="connections.html#spark-home"><i class="fa fa-check"></i><b>6.1.2</b> Spark Home</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="connections.html"><a href="connections.html#types"><i class="fa fa-check"></i><b>6.2</b> Types</a><ul>
<li class="chapter" data-level="6.2.1" data-path="connections.html"><a href="connections.html#connection-local"><i class="fa fa-check"></i><b>6.2.1</b> Local</a></li>
<li class="chapter" data-level="6.2.2" data-path="connections.html"><a href="connections.html#standalone"><i class="fa fa-check"></i><b>6.2.2</b> Standalone</a></li>
<li class="chapter" data-level="6.2.3" data-path="connections.html"><a href="connections.html#yarn-1"><i class="fa fa-check"></i><b>6.2.3</b> Yarn</a></li>
<li class="chapter" data-level="6.2.4" data-path="connections.html"><a href="connections.html#livy"><i class="fa fa-check"></i><b>6.2.4</b> Livy</a></li>
<li class="chapter" data-level="6.2.5" data-path="connections.html"><a href="connections.html#mesos-1"><i class="fa fa-check"></i><b>6.2.5</b> Mesos</a></li>
<li class="chapter" data-level="6.2.6" data-path="connections.html"><a href="connections.html#kubernetes-1"><i class="fa fa-check"></i><b>6.2.6</b> Kubernetes</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="connections.html"><a href="connections.html#troubleshooting"><i class="fa fa-check"></i><b>6.3</b> Troubleshooting</a><ul>
<li class="chapter" data-level="6.3.1" data-path="connections.html"><a href="connections.html#logging"><i class="fa fa-check"></i><b>6.3.1</b> Logging</a></li>
<li class="chapter" data-level="6.3.2" data-path="connections.html"><a href="connections.html#troubleshoot-spark-submit"><i class="fa fa-check"></i><b>6.3.2</b> Spark Submit</a></li>
<li class="chapter" data-level="6.3.3" data-path="connections.html"><a href="connections.html#multiple"><i class="fa fa-check"></i><b>6.3.3</b> Multiple</a></li>
<li class="chapter" data-level="6.3.4" data-path="connections.html"><a href="connections.html#windows"><i class="fa fa-check"></i><b>6.3.4</b> Windows</a></li>
<li class="chapter" data-level="6.3.5" data-path="connections.html"><a href="connections.html#submit-manually"><i class="fa fa-check"></i><b>6.3.5</b> Submit Manually</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="connections.html"><a href="connections.html#recap-1"><i class="fa fa-check"></i><b>6.4</b> Recap</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>7</b> Data</a><ul>
<li class="chapter" data-level="7.1" data-path="data.html"><a href="data.html#overview-4"><i class="fa fa-check"></i><b>7.1</b> Overview</a></li>
<li class="chapter" data-level="7.2" data-path="data.html"><a href="data.html#dataframes"><i class="fa fa-check"></i><b>7.2</b> DataFrames</a><ul>
<li class="chapter" data-level="7.2.1" data-path="data.html"><a href="data.html#data-sdf-functions"><i class="fa fa-check"></i><b>7.2.1</b> Functions</a></li>
<li class="chapter" data-level="7.2.2" data-path="data.html"><a href="data.html#pivoting"><i class="fa fa-check"></i><b>7.2.2</b> Pivoting</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="data.html"><a href="data.html#formats"><i class="fa fa-check"></i><b>7.3</b> Formats</a></li>
<li class="chapter" data-level="7.4" data-path="data.html"><a href="data.html#data-types"><i class="fa fa-check"></i><b>7.4</b> Data Types</a><ul>
<li class="chapter" data-level="7.4.1" data-path="data.html"><a href="data.html#dates"><i class="fa fa-check"></i><b>7.4.1</b> Dates</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="data.html"><a href="data.html#external"><i class="fa fa-check"></i><b>7.5</b> External</a><ul>
<li class="chapter" data-level="7.5.1" data-path="data.html"><a href="data.html#amazon-s3"><i class="fa fa-check"></i><b>7.5.1</b> Amazon S3</a></li>
<li class="chapter" data-level="7.5.2" data-path="data.html"><a href="data.html#azure-storage"><i class="fa fa-check"></i><b>7.5.2</b> Azure Storage</a></li>
<li class="chapter" data-level="7.5.3" data-path="data.html"><a href="data.html#cassandra"><i class="fa fa-check"></i><b>7.5.3</b> Cassandra</a></li>
<li class="chapter" data-level="7.5.4" data-path="data.html"><a href="data.html#databases"><i class="fa fa-check"></i><b>7.5.4</b> Databases</a></li>
<li class="chapter" data-level="7.5.5" data-path="data.html"><a href="data.html#hbase"><i class="fa fa-check"></i><b>7.5.5</b> HBase</a></li>
<li class="chapter" data-level="7.5.6" data-path="data.html"><a href="data.html#nested-data"><i class="fa fa-check"></i><b>7.5.6</b> Nested Data</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="data.html"><a href="data.html#troubleshooting-1"><i class="fa fa-check"></i><b>7.6</b> Troubleshooting</a><ul>
<li class="chapter" data-level="7.6.1" data-path="data.html"><a href="data.html#troubleshoot-csvs"><i class="fa fa-check"></i><b>7.6.1</b> Troubleshoot CSVs</a></li>
<li class="chapter" data-level="7.6.2" data-path="data.html"><a href="data.html#column-names"><i class="fa fa-check"></i><b>7.6.2</b> Column Names</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="data.html"><a href="data.html#recap-2"><i class="fa fa-check"></i><b>7.7</b> Recap</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="tuning.html"><a href="tuning.html"><i class="fa fa-check"></i><b>8</b> Tuning</a><ul>
<li class="chapter" data-level="8.1" data-path="tuning.html"><a href="tuning.html#overview-5"><i class="fa fa-check"></i><b>8.1</b> Overview</a><ul>
<li class="chapter" data-level="8.1.1" data-path="tuning.html"><a href="tuning.html#tunning-graph-visualization"><i class="fa fa-check"></i><b>8.1.1</b> Graph Visualization</a></li>
<li class="chapter" data-level="8.1.2" data-path="tuning.html"><a href="tuning.html#tunning-event-timeline"><i class="fa fa-check"></i><b>8.1.2</b> Event Timeline</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="tuning.html"><a href="tuning.html#tunning-configuring"><i class="fa fa-check"></i><b>8.2</b> Configuring</a><ul>
<li class="chapter" data-level="8.2.1" data-path="tuning.html"><a href="tuning.html#submit-settings"><i class="fa fa-check"></i><b>8.2.1</b> Submit Settings</a></li>
<li class="chapter" data-level="8.2.2" data-path="tuning.html"><a href="tuning.html#runtime-settings"><i class="fa fa-check"></i><b>8.2.2</b> Runtime Settings</a></li>
<li class="chapter" data-level="8.2.3" data-path="tuning.html"><a href="tuning.html#sparklyr-settings"><i class="fa fa-check"></i><b>8.2.3</b> sparklyr Settings</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="tuning.html"><a href="tuning.html#tunning-partitioning"><i class="fa fa-check"></i><b>8.3</b> Partitioning</a><ul>
<li class="chapter" data-level="8.3.1" data-path="tuning.html"><a href="tuning.html#implicit"><i class="fa fa-check"></i><b>8.3.1</b> Implicit</a></li>
<li class="chapter" data-level="8.3.2" data-path="tuning.html"><a href="tuning.html#explicit"><i class="fa fa-check"></i><b>8.3.2</b> Explicit</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="tuning.html"><a href="tuning.html#tunning-caching"><i class="fa fa-check"></i><b>8.4</b> Caching</a><ul>
<li class="chapter" data-level="8.4.1" data-path="tuning.html"><a href="tuning.html#checkpointing"><i class="fa fa-check"></i><b>8.4.1</b> Checkpointing</a></li>
<li class="chapter" data-level="8.4.2" data-path="tuning.html"><a href="tuning.html#tunning-memory"><i class="fa fa-check"></i><b>8.4.2</b> Memory</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="tuning.html"><a href="tuning.html#tunning-shuffling"><i class="fa fa-check"></i><b>8.5</b> Shuffling</a></li>
<li class="chapter" data-level="8.6" data-path="tuning.html"><a href="tuning.html#tunning-serialization"><i class="fa fa-check"></i><b>8.6</b> Serialization</a></li>
<li class="chapter" data-level="8.7" data-path="tuning.html"><a href="tuning.html#recap-3"><i class="fa fa-check"></i><b>8.7</b> Recap</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="extensions.html"><a href="extensions.html"><i class="fa fa-check"></i><b>9</b> Extensions</a><ul>
<li class="chapter" data-level="9.1" data-path="extensions.html"><a href="extensions.html#rsparkling"><i class="fa fa-check"></i><b>9.1</b> RSparkling</a><ul>
<li class="chapter" data-level="9.1.1" data-path="extensions.html"><a href="extensions.html#trpoubleshooting"><i class="fa fa-check"></i><b>9.1.1</b> Trpoubleshooting</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="extensions.html"><a href="extensions.html#graphframes"><i class="fa fa-check"></i><b>9.2</b> GraphFrames</a></li>
<li class="chapter" data-level="9.3" data-path="extensions.html"><a href="extensions.html#mleap"><i class="fa fa-check"></i><b>9.3</b> Mleap</a></li>
<li class="chapter" data-level="9.4" data-path="extensions.html"><a href="extensions.html#extensions-nested-data"><i class="fa fa-check"></i><b>9.4</b> Nested Data</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="distributed.html"><a href="distributed.html"><i class="fa fa-check"></i><b>10</b> Distributed R</a><ul>
<li class="chapter" data-level="10.1" data-path="distributed.html"><a href="distributed.html#use-cases"><i class="fa fa-check"></i><b>10.1</b> Use Cases</a><ul>
<li class="chapter" data-level="10.1.1" data-path="distributed.html"><a href="distributed.html#embarrassingly-parallel"><i class="fa fa-check"></i><b>10.1.1</b> Embarrassingly Parallel</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="distributed.html"><a href="distributed.html#columns"><i class="fa fa-check"></i><b>10.2</b> Columns</a><ul>
<li class="chapter" data-level="10.2.1" data-path="distributed.html"><a href="distributed.html#inference"><i class="fa fa-check"></i><b>10.2.1</b> Inference</a></li>
<li class="chapter" data-level="10.2.2" data-path="distributed.html"><a href="distributed.html#excplicit"><i class="fa fa-check"></i><b>10.2.2</b> Excplicit</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="distributed.html"><a href="distributed.html#grouping"><i class="fa fa-check"></i><b>10.3</b> Grouping</a></li>
<li class="chapter" data-level="10.4" data-path="distributed.html"><a href="distributed.html#packages"><i class="fa fa-check"></i><b>10.4</b> Packages</a></li>
<li class="chapter" data-level="10.5" data-path="distributed.html"><a href="distributed.html#context"><i class="fa fa-check"></i><b>10.5</b> Context</a></li>
<li class="chapter" data-level="10.6" data-path="distributed.html"><a href="distributed.html#restrictions"><i class="fa fa-check"></i><b>10.6</b> Restrictions</a><ul>
<li class="chapter" data-level="10.6.1" data-path="distributed.html"><a href="distributed.html#troubleshooting-2"><i class="fa fa-check"></i><b>10.6.1</b> Troubleshooting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="streaming.html"><a href="streaming.html"><i class="fa fa-check"></i><b>11</b> Streaming</a><ul>
<li class="chapter" data-level="11.1" data-path="streaming.html"><a href="streaming.html#overview-6"><i class="fa fa-check"></i><b>11.1</b> Overview</a></li>
<li class="chapter" data-level="11.2" data-path="streaming.html"><a href="streaming.html#transformations"><i class="fa fa-check"></i><b>11.2</b> Transformations</a><ul>
<li class="chapter" data-level="11.2.1" data-path="streaming.html"><a href="streaming.html#streams-dplyr"><i class="fa fa-check"></i><b>11.2.1</b> dplyr</a></li>
<li class="chapter" data-level="11.2.2" data-path="streaming.html"><a href="streaming.html#streams-pipelines"><i class="fa fa-check"></i><b>11.2.2</b> Pipelines</a></li>
<li class="chapter" data-level="11.2.3" data-path="streaming.html"><a href="streaming.html#streams-r"><i class="fa fa-check"></i><b>11.2.3</b> R Code</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="streaming.html"><a href="streaming.html#shiny"><i class="fa fa-check"></i><b>11.3</b> Shiny</a></li>
<li class="chapter" data-level="11.4" data-path="streaming.html"><a href="streaming.html#formats-1"><i class="fa fa-check"></i><b>11.4</b> Formats</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="contributing.html"><a href="contributing.html"><i class="fa fa-check"></i><b>12</b> Contributing</a><ul>
<li class="chapter" data-level="12.1" data-path="contributing.html"><a href="contributing.html#overview-7"><i class="fa fa-check"></i><b>12.1</b> Overview</a></li>
<li class="chapter" data-level="12.2" data-path="contributing.html"><a href="contributing.html#contributing-r-extension"><i class="fa fa-check"></i><b>12.2</b> R Extensions</a></li>
<li class="chapter" data-level="12.3" data-path="contributing.html"><a href="contributing.html#scala-extensions"><i class="fa fa-check"></i><b>12.3</b> Scala Extensions</a><ul>
<li class="chapter" data-level="12.3.1" data-path="contributing.html"><a href="contributing.html#scala-extension-prereq"><i class="fa fa-check"></i><b>12.3.1</b> Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="contributing.html"><a href="contributing.html#spark-extensions"><i class="fa fa-check"></i><b>12.4</b> Spark Extensions</a></li>
<li class="chapter" data-level="12.5" data-path="contributing.html"><a href="contributing.html#r-packages"><i class="fa fa-check"></i><b>12.5</b> R Packages</a><ul>
<li class="chapter" data-level="12.5.1" data-path="contributing.html"><a href="contributing.html#rstudio-projects"><i class="fa fa-check"></i><b>12.5.1</b> RStudio Projects</a></li>
<li class="chapter" data-level="12.5.2" data-path="contributing.html"><a href="contributing.html#troubleshooting-3"><i class="fa fa-check"></i><b>12.5.2</b> Troubleshooting</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="contributing.html"><a href="contributing.html#contributing-sparklyr"><i class="fa fa-check"></i><b>12.6</b> sparklyr</a><ul>
<li class="chapter" data-level="12.6.1" data-path="contributing.html"><a href="contributing.html#compiling"><i class="fa fa-check"></i><b>12.6.1</b> Compiling</a></li>
<li class="chapter" data-level="12.6.2" data-path="contributing.html"><a href="contributing.html#serialization"><i class="fa fa-check"></i><b>12.6.2</b> Serialization</a></li>
<li class="chapter" data-level="12.6.3" data-path="contributing.html"><a href="contributing.html#invocations"><i class="fa fa-check"></i><b>12.6.3</b> Invocations</a></li>
<li class="chapter" data-level="12.6.4" data-path="contributing.html"><a href="contributing.html#r-packages-1"><i class="fa fa-check"></i><b>12.6.4</b> R Packages</a></li>
<li class="chapter" data-level="12.6.5" data-path="contributing.html"><a href="contributing.html#connections-1"><i class="fa fa-check"></i><b>12.6.5</b> Connections</a></li>
<li class="chapter" data-level="12.6.6" data-path="contributing.html"><a href="contributing.html#distributed-r"><i class="fa fa-check"></i><b>12.6.6</b> Distributed R</a></li>
</ul></li>
<li class="chapter" data-level="12.7" data-path="contributing.html"><a href="contributing.html#recap-4"><i class="fa fa-check"></i><b>12.7</b> Recap</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i><b>13</b> Appendix</a><ul>
<li class="chapter" data-level="13.1" data-path="appendix.html"><a href="appendix.html#diagrams"><i class="fa fa-check"></i><b>13.1</b> Diagrams</a><ul>
<li class="chapter" data-level="13.1.1" data-path="appendix.html"><a href="appendix.html#appendix-storage-capacity"><i class="fa fa-check"></i><b>13.1.1</b> Worlds Store Capacity</a></li>
<li class="chapter" data-level="13.1.2" data-path="appendix.html"><a href="appendix.html#appendix-cran-downloads"><i class="fa fa-check"></i><b>13.1.2</b> Daily downloads of CRAN packages</a></li>
<li class="chapter" data-level="13.1.3" data-path="appendix.html"><a href="appendix.html#appendix-cluster-trends"><i class="fa fa-check"></i><b>13.1.3</b> Google trends for mainframes, cloud computing and kubernetes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>14</b> References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The R in Spark: Learning Apache Spark with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="clusters" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> Clusters</h1>
<p>Previous chapters focused on using Spark over a single computing instance, your personal computer. In this chapter we will introduce techniques to run Spark over multiple computing instances, also known as a computing cluster, to analyze and model data at scale.</p>
<p>If you already have a Spark cluster in your organization, you could consider skipping to the next chapter, <a href="connections.html#connections">connections</a>, which will teach you how to connect to an existing cluster.</p>
<p>If you don’t have a cluster or are considering improvements to your existing infrastructure, this chapter will introduce the cluster trends, managers and providers available today.</p>
<div id="overview-2" class="section level2">
<h2><span class="header-section-number">5.1</span> Overview</h2>
<p>There are three major trends in cluster computing worth discussing: <strong>on-premise</strong>, <strong>cloud computing</strong> and <strong>kubernetes</strong>. Framing these trends over time will help us understand how they came to be, what they are and what their future might be:</p>
<div class="figure">
<img src="images/clusters-trends.png" alt="Google trends for on-premise (mainframe), cloud computing and kubernetes." />
<p class="caption">Google trends for on-premise (mainframe), cloud computing and kubernetes.</p>
</div>
<p>For <strong>on-premise</strong> clusters, someone, either yourself or someone in your organization purchased physical computers that were intended to be used for cluster computing. The computers in this cluster are made of <em>off-the-shelf</em> hardware, meaning that someone placed an order to purchase computers usually found in stores shelves or, <em>high-performance</em> hardware, meaning that a computing vendor provided highly customized computing hardware which also comes optimized for high-performance network connectivity, power consumption, etc. When purchasing hundreds or thousands of computing instances, it doesn’t make sense to keep them in the usual computing case that we are all familiar with, but rather, it makes sense to stack them as efficient as possible on top of each other to minimize room space. This group of efficiently stacked computing instances is known as a <a href="https://en.wikipedia.org/wiki/Rack_unit">rack</a>. Once a cluster grows to thousands of computers, you will also need to host hundreds of racks of computing devices, at this scale, you would also need significant physical space to hosts those racks. A building that provides racks of computing instances is usually known as a <em>data-center</em>. At the scale of a data center, optimizing the building that holds them, their heating system, power supply, network connectivity, etc. becomes also relevant to optimize. In 2011, Facebook <a href="https://code.facebook.com/posts/187637061409082/building-efficient-data-centers-with-the-open-compute-project/">announced</a> the <a href="http://www.opencompute.org/">Open Compute Project</a> initiative which provides a set of data center blueprints free for anyone to use.</p>
<p>There is nothing preventing us from building our own data centers and in fact, many organizations have followed this path. For instance, Amazon started as an online book store, over the years Amazon grew to sell much more than just books and, with it’s online store growth, their data centers also grew in size. In 2002, Amazon considered <a href="https://en.wikipedia.org/wiki/Amazon_Web_Services#History">selling access to virtual servers</a>, in their data centers to the public and, in 2004, Amazon Web Services launched as a way to let anyone rent a subset of their data centers on-demand, meaning that one did not have to purchase, configure, maintain nor teardown it’s own clusters but could rather rent them from Amazon directly.</p>
<p>The on-demand compute model is what we know today as <strong>Cloud Computing</strong>. It’s a concept that evolved from Amazon Web Services providing their data centers as a service. In the cloud, the cluster you use is not owned by you and it’s neither in your physical building, but rather, it’s a data center owned and managed by someone else. Today, there are many cloud providers in this space ranging from Amazon, Databricks, IBM, Googla, Microsoft and many others. Most cloud computing platforms provide a user interface either through a web application and command line to request and manage resources.</p>
<p>While the benefits of processing data in the <em>cloud</em> were obvious for many years, picking a cloud provider had the unintended side-effect of locking organizations with one particular provider, making it hard to switch between providers or back to on-premise clusters. <strong>Kubernetes</strong>, announced by Google in 2014, is an <a href="https://github.com/kubernetes/kubernetes/">open source system for managing containerized applications across multiple hosts</a>. In practice, it provides common infrastructure otherwise proprietary to cloud providers making it much easier to deploy across multiple cloud providers and on-premise as well. However, being a much newer paradigm than on-premise or cloud computing, it is still in it’s adoption phase but, nevertheless, promising for cluster computing in general and, specifically, for Apache Spark.</p>
</div>
<div id="managers" class="section level2">
<h2><span class="header-section-number">5.2</span> Managers</h2>
<p>In order to run Spark within a computing cluster, one needs to run something capable of initializing Spark over each compute instance, this is known as a <a href="https://en.wikipedia.org/wiki/Cluster_manager">cluster manager</a>. The available cluster managers in Spark are: <strong>Spark Standalone</strong>, <strong>YARN</strong>, <strong>Mesos</strong> and <strong>Kubernetes</strong>.</p>
<div id="clusters-standalone" class="section level3">
<h3><span class="header-section-number">5.2.1</span> Standalone</h3>
<p>In <strong>Spark Standalone</strong>, Spark works on it’s own without additional software requirements since it provides it’s own cluster manager as part of the Spark installation.</p>
<div class="figure">
<img src="images/clusters-spark-standalone.png" alt="Spark Standalone Site." />
<p class="caption">Spark Standalone Site.</p>
</div>
<p>By completing the <a href="starting.html#starting">getting started</a> chapter, you should have a local Spark installation available, which we can use to initialize a local standalone Spark cluster. First, retrieve the <code>SPARK_HOME</code> directory by running <code>sparklyr::spark_home_dir()</code> from R and then, from a terminal or R, use <code>start-master.sh</code> and <code>start-slave.sh</code> as follows:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># Retrieve the Spark installation directory</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2">spark_home &lt;-<span class="st"> </span>sparklyr<span class="op">::</span><span class="kw">spark_home_dir</span>()</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="co"># Build path to start-master.sh</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5">start_master &lt;-<span class="st"> </span><span class="kw">file.path</span>(spark_home, <span class="st">&quot;sbin&quot;</span>, <span class="st">&quot;start-master.sh&quot;</span>)</a>
<a class="sourceLine" id="cb1-6" data-line-number="6"></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="co"># Execute start-master.sh to start the cluster manager master node</span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="kw">system2</span>(start_master)</a>
<a class="sourceLine" id="cb1-9" data-line-number="9"></a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="co"># Build path to start-slave</span></a>
<a class="sourceLine" id="cb1-11" data-line-number="11">start_slave &lt;-<span class="st"> </span><span class="kw">file.path</span>(spark_home, <span class="st">&quot;sbin&quot;</span>, <span class="st">&quot;start-slave.sh&quot;</span>)</a>
<a class="sourceLine" id="cb1-12" data-line-number="12"></a>
<a class="sourceLine" id="cb1-13" data-line-number="13"><span class="co"># Execute start-slave.sh to start a worker and register in master node</span></a>
<a class="sourceLine" id="cb1-14" data-line-number="14"><span class="kw">system2</span>(start_slave, <span class="kw">paste0</span>(<span class="st">&quot;spark://&quot;</span>, <span class="kw">system2</span>(<span class="st">&quot;hostname&quot;</span>, <span class="dt">stdout =</span> <span class="ot">TRUE</span>), <span class="st">&quot;:7077&quot;</span>))</a></code></pre></div>
<p>The previous command initialized the master node and a worker node, the master node interface can be accessed under <a href="http://localhost:8080">localhost:8080</a> and looks like the following:</p>
<div class="figure">
<img src="images/clusters-spark-standalone-web-ui.png" alt="Spark Standalone Web Interface." />
<p class="caption">Spark Standalone Web Interface.</p>
</div>
<p>Notice that there is one worker register in Spark standalone, you can follow the link to this worker node to see additional information:</p>
<div class="figure">
<img src="images/clusters-spark-standalone-web-ui-worker.png" alt="Spark Standalone Worker Web Interface." />
<p class="caption">Spark Standalone Worker Web Interface.</p>
</div>
<p>Once data analysis is complete, one can simply stop all the running nodes in this local cluster by running:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">stop_all &lt;-<span class="st"> </span><span class="kw">file.path</span>(spark_home, <span class="st">&quot;sbin&quot;</span>, <span class="st">&quot;stop-all.sh&quot;</span>)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw">system2</span>(stop_all)</a></code></pre></div>
<p>A similar approach can be followed to configure a cluster by running each <code>start-slave.sh</code> command over each machine in the cluster.</p>
<p>Further reading: <a href="https://spark.apache.org/docs/latest/spark-standalone.html">Spark Standalone Mode</a></p>
</div>
<div id="yarn" class="section level3">
<h3><span class="header-section-number">5.2.2</span> Yarn</h3>
<p>YARN for short, or Hadoop YARN, is the resource manager introduced in 2012 to the Hadoop project. As mentioned in in the <a href="#introduction">introduction</a> chapter, Spark was built initially to speed up computation over Hadoop; then, when Hadoop 2 was launched, it introduced YARN as a component to manage resources in the cluster, to this date, using Hadoop YARN with Apache Spark is still very common.</p>
<p>YARN applications can be submitted in two modes: <strong>yarn-client</strong> and <strong>yarn-cluster</strong>. In yarn-cluster mode the driver is running remotely, while in yarn-client mode, the driver is on the machine that started the job, <code>sparklyr</code> supports both modes.</p>
<div class="figure">
<img src="images/clusters-yarn.png" alt="Hadoop YARN Site." />
<p class="caption">Hadoop YARN Site.</p>
</div>
<p>Further reading: <a href="https://spark.apache.org/docs/latest/running-on-yarn.html">Running Spark on YARN</a></p>
</div>
<div id="mesos" class="section level3">
<h3><span class="header-section-number">5.2.3</span> Mesos</h3>
<p>Apache Mesos is an open-source project to manage computer clusters. Mesos began as a research project in the UC Berkeley RAD Lab by then PhD students Benjamin Hindman, Andy Konwinski, and Matei Zaharia, as well as professor Ion Stoica. Mesos uses Linux <a href="https://en.wikipedia.org/wiki/Cgroups">Cgroups</a> to provide isolation for CPU, memory, I/O and file system.</p>
<div class="figure">
<img src="images/clusters-mesos.png" alt="Mesos Landing Site." />
<p class="caption">Mesos Landing Site.</p>
</div>
<p>Further reading: <a href="https://spark.apache.org/docs/latest/running-on-mesos.html">Running Spark on Mesos</a></p>
</div>
<div id="kubernetes" class="section level3">
<h3><span class="header-section-number">5.2.4</span> Kubernetes</h3>
<p>Kubernetes is an open-source container-orchestration system for automating deployment, scaling and management of containerized applications that was originally designed by Google and now maintained by the <a href="https://www.cncf.io/">Cloud Native Computing Foundation</a>.</p>
<div class="figure">
<img src="images/clusters-kubernetes.png" alt="Kubernetes Landing Site." />
<p class="caption">Kubernetes Landing Site.</p>
</div>
<p>Further reading: <a href="https://spark.apache.org/docs/latest/running-on-kubernetes.html">Running Spark on Kubernetes</a></p>
</div>
</div>
<div id="on-premise" class="section level2">
<h2><span class="header-section-number">5.3</span> On-Premise</h2>
<p>As mentioned in the overview section, on-premise clusters represent a set of computing instances procured, colocated and managed by staff members from your organization. These clusters can be highly customized and controlled; however, they can also incur significant initial expenses and maintenance costs.</p>
<p>One can use a cluster manager in on-premise clusters as described in the previous section; however, many organizations choose to partner with companies providing additional management software, services and resources to manage software in their cluster including, but not limited to, Apache Spark. Some of the on-premise cluster providers include: Cloudera, Hortonworks and MapR to mention a few which will be briefly introduced.</p>
<div id="cloudera" class="section level3">
<h3><span class="header-section-number">5.3.1</span> Cloudera</h3>
<p>Cloudera, Inc. is a United States-based software company that provides Apache Hadoop and Apache Spark-based software, support and services, and training to business customers.</p>
<p>Cloudera’s hybrid open-source Apache Hadoop distribution, CDH (Cloudera Distribution Including Apache Hadoop), targets enterprise-class deployments of that technology. Cloudera says that more than 50% of its engineering output is donated upstream to the various Apache-licensed open source projects (Apache Hive, Apache Avro, Apache HBase, and so on) that combine to form the Apache Hadoop platform. Cloudera is also a sponsor of the Apache Software Foundation.</p>
<div class="figure">
<img src="images/clusters-cloudera.png" alt="Cloudera Landing Site." />
<p class="caption">Cloudera Landing Site.</p>
</div>
</div>
<div id="hortonworks" class="section level3">
<h3><span class="header-section-number">5.3.2</span> Hortonworks</h3>
<p>Hortonworks is a big data software company based in Santa Clara, California. The company develops, supports, and provides expertise on an expansive set of entirely open source software designed to manage data and processing for everything from IOT, to advanced analytics and machine learning. Hortonworks believes it is a data management company bridging the cloud and the datacenter.</p>
<div class="figure">
<img src="images/clusters-hortonworks.png" alt="Hortonworks Landing Site." />
<p class="caption">Hortonworks Landing Site.</p>
</div>
</div>
<div id="mapr" class="section level3">
<h3><span class="header-section-number">5.3.3</span> MapR</h3>
<p>MapR is a business software company headquartered in Santa Clara, California. MapR provides access to a variety of data sources from a single computer cluster, including big data workloads such as Apache Hadoop and Apache Spark, a distributed file system, a multi-model database management system, and event stream processing, combining analytics in real-time with operational applications. Its technology runs on both commodity hardware and public cloud computing services.</p>
<div class="figure">
<img src="images/clusters-mapr.png" alt="MapR Landing Site." />
<p class="caption">MapR Landing Site.</p>
</div>
</div>
</div>
<div id="cloud" class="section level2">
<h2><span class="header-section-number">5.4</span> Cloud</h2>
<p>For those readers that don’t have a cluster yet, it is likely that you will want to choose a cloud cluster, this section will briefly mention some of the major cloud infrastructure providers as a starting point to choose the right one for you.</p>
<p>It is worth mentioning that in a cloud service model, the compute instances are charged by the hour and times the number of instances reserved for your cluster. Since the cluster size is flexible, it is a good practice to start with small clusters and scale compute resources as needed. Even if you know in advance that a cluster of significant size will be required, starting small provides an opportunity to troubleshoot issues at a lower cost since it’s unlikely that your data analysis will run at scale flawlessly on the first try.</p>
<p>The major providers of cloud computing infrastructure are: Amazon, Google and Microsoft that this section will briefly introduce.</p>
<div id="amazon" class="section level3">
<h3><span class="header-section-number">5.4.1</span> Amazon</h3>
<p>Amazon provides cloud services through <a href="https://aws.amazon.com/">Amazon Web Services</a>; more specifically, they provide an on-demand Spark cluster through <a href="https://aws.amazon.com/emr/">Amazon Elastic MapReduce</a> or EMR for short.</p>
<div class="figure">
<img src="images/clusters-amazon-emr.png" alt="Amazon EMR Landing Site." />
<p class="caption">Amazon EMR Landing Site.</p>
</div>
</div>
<div id="databricks" class="section level3">
<h3><span class="header-section-number">5.4.2</span> Databricks</h3>
<p><a href="http://databricks.com">Databricks</a> is a company founded by the creators of Apache Spark, that aims to help clients with cloud-based big data processing using Spark. Databricks grew out of the <a href="https://amplab.cs.berkeley.edu/">AMPLab</a> project at University of California, Berkeley.</p>
<div class="figure">
<img src="images/clusters-databricks.png" alt="Databricks Landing Site." />
<p class="caption">Databricks Landing Site.</p>
</div>
</div>
<div id="google" class="section level3">
<h3><span class="header-section-number">5.4.3</span> Google</h3>
<p>Google provides their on-demand computing services through their <a href="https://cloud.google.com/">Google Cloud</a>, on-demand Spark cluster are provided by <a href="https://cloud.google.com/dataproc/">Google Dataproc</a>.</p>
<div class="figure">
<img src="images/clusters-dataproc.png" alt="Google Dataprox Landing Site." />
<p class="caption">Google Dataprox Landing Site.</p>
</div>
</div>
<div id="ibm" class="section level3">
<h3><span class="header-section-number">5.4.4</span> IBM</h3>
<p>IBM provides cloud services through <a href="https://www.ibm.com/cloud">IBM Cloud</a>, it supports several programming languages and services, including <a href="https://www.ibm.com/cloud/spark">Apache Spark</a>.</p>
<div class="figure">
<img src="images/clusters-ibm.png" alt="IBM Landing Site." />
<p class="caption">IBM Landing Site.</p>
</div>
</div>
<div id="microsoft" class="section level3">
<h3><span class="header-section-number">5.4.5</span> Microsoft</h3>
<p>Microsoft provides cloud services through <a href="https://azure.microsoft.com/">Microsoft Azure</a> and Spark clusters through <a href="https://azure.microsoft.com/en-us/services/hdinsight/">Azure HDInsight</a>.</p>
<div class="figure">
<img src="images/clusters-azure.png" alt="Azure HDInsight Landing Site." />
<p class="caption">Azure HDInsight Landing Site.</p>
</div>
</div>
</div>
<div id="tools" class="section level2">
<h2><span class="header-section-number">5.5</span> Tools</h2>
<p>While using only R and Spark can be sufficient for some clusters, it is common to install complementary tools in your cluster to improve: monitoring, sql analysis, workflow coordination, etc. with applications like <a href="http://ganglia.info/">Ganglia</a>, <a href="http://gethue.com/">Hue</a> and <a href="https://oozie.apache.org">Oozie</a> respectively. This section is not meant to cover all, but rather mention two that are relevant to R and <code>sparklyr</code>.</p>
<div id="rstudio" class="section level3">
<h3><span class="header-section-number">5.5.1</span> RStudio</h3>
<p>RStudio’s open source and professional products, like: RStudio Server, <a href="https://www.rstudio.com/products/rstudio-server-pro/">RStudio Server Pro</a>, <a href="https://www.rstudio.com/products/shiny/">Shiny Server</a>, <a href="https://www.rstudio.com/products/shiny-server-pro/">Shiny Server Pro</a>, or <a href="https://www.rstudio.com/products/connect/">RStudio Connect</a>; can be installed within the cluster to support many R workflows, while <code>sparklyr</code> does not require any additional tools, they provide significant productivity gains worth considering.</p>
<div class="figure">
<img src="images/clusters-server.png" alt="RStudio Server." />
<p class="caption">RStudio Server.</p>
</div>
</div>
<div id="jupyter" class="section level3">
<h3><span class="header-section-number">5.5.2</span> Jupyter</h3>
<p>Project <a href="http://jupyter.org/">Jupyter</a> exists to develop open-source software, open-standards, and services for interactive computing across dozens of programming languages.</p>
<div class="figure">
<img src="images/clusters-jupyter.png" alt="Project Jupyter." />
<p class="caption">Project Jupyter.</p>
</div>
<p>Their notebooks, provide support for various programming languages, including R. <code>sparklyr</code> can be used with Jupyter notebooks using the R Kernel.</p>
</div>
<div id="clusters-livy" class="section level3">
<h3><span class="header-section-number">5.5.3</span> Livy</h3>
<p><a href="https://livy.incubator.apache.org/">Apache Livy</a> is an incubation project in Apache providing support to use Spark clusters remotely through a web interface. It is ideal to connect directly into the Spark cluster; however, there are times where connecting directly to the cluster is not feasible. When facing those constraints, one can consider installing Livy in their cluster and secure it properly to enable remote use over web protocols.</p>
<p>However, there is a significant performance overhead from using Livy in <code>sparklyr</code> for experimentation, meaning that, executing many client comamnds over Livy has a significant overhead; however, running a few commands to generate complex analysis is usually performant since the performance overhead of starting computation can be insignificant compared to the actual cluster computation.</p>
<div class="figure">
<img src="images/clusters-apache-livy.png" alt="Apache Livy Landing Site." />
<p class="caption">Apache Livy Landing Site.</p>
</div>
<p>To help test Livy locally, <code>sparklyr</code> provides support to list, install, start and stop a local Livy instance by executing:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co"># List versions of Livy available to install</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="kw">livy_available_versions</span>()</a></code></pre></div>
<pre><code>##    livy
## 1 0.2.0
## 2 0.3.0
## 3 0.4.0
## 4 0.5.0</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="co"># Install default Livy version</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="kw">livy_install</span>()</a>
<a class="sourceLine" id="cb5-3" data-line-number="3"></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="co"># List installed Livy services</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="kw">livy_installed_versions</span>()</a>
<a class="sourceLine" id="cb5-6" data-line-number="6"></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co"># Start the Livy service</span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="kw">livy_service_start</span>()</a>
<a class="sourceLine" id="cb5-9" data-line-number="9"></a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="co"># Stops the Livy service</span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11"><span class="kw">livy_service_stop</span>()</a></code></pre></div>
<p>The default address for this local Livy service is <a href="http://localhost:8998" class="uri">http://localhost:8998</a></p>
</div>
</div>
<div id="recap" class="section level2">
<h2><span class="header-section-number">5.6</span> Recap</h2>
<p>This chapter explained the history and tradeoffs of on-premise, cloud computing and presented Kubernetes as a promising framework to provide flexibility across on-premise and cloud providers. It also introduced cluster managers (Spark Standalone, YARN, Mesos and Kubernetes) as the software needed to run Spark as a cluster application. This chapter briefly mentioned on-premise cluster providers like Cloudera, Hortonworks and MapR as well as the major cloud providers: Amazon, Google and Microsoft.</p>
<p>While this chapter provided a solid foundation to understand current cluster computing trends, tools and providers useful to perform data science at scale; it did not provide a comprehensive framework to decide which cluster technologies to choose. Instead, use this chapter as an overview and a starting point to reach out to additional resources to complement your understanding the cluster stack that best fits your organization needs.</p>
<p>The next chapter, <a href="connections.html#connections">connections</a>, will focus on understanding how to connect to existing clusters; therefore, it assumes a Spark cluster like the ones presented in this chapter, is already available to you.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="modeling.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="connections.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
